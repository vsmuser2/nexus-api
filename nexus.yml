---
- hosts: local
  vars:
    aptrepos:
    - url: http://localhost:8081/service/rest/v1/repositories/apt/hosted
      name: abc
    - url: http://localhost:8081/service/rest/v1/repositories/apt/hosted
      name: xyz 
    mavenrepos:
    - url: http://localhost:8081/service/rest/v1/repositories/maven/hosted
      name: maven1 
    - url: http://localhost:8081/service/rest/v1/repositories/maven/hosted
      name: maven2
  tasks:
  - name: Create a nexus apt repo
    uri:
      url: "{{ item.url }}"
      method: POST
      user: admin
      password: admin123
      headers:
        Content-Type: application/json
        Accept: application/json
      body: 
        mainlevel:
          subkey: finalvalue
        name: "{{ item.name }}"
        online: "true"
        storage: 
          blobStoreName: default
          strictContentTypeValidation: "true"
          writePolicy: allow_once
        cleanup:
          policyNames: 
            - string
        component:
          proprietaryComponents: "true"
        apt:
          distribution: bionic
        aptSigning:
          keypair: string
          passphrase: string
      force_basic_auth: "yes"
      status_code: 201
      body_format: json
    with_items: "{{ aptrepos }}"
    ignore_errors: "yes"
  - name: Create a nexus maven repo
    uri:
      url: "{{ item.url }}"
      method: POST
      user: admin
      password: admin123
      headers:
        Content-Type: application/json
        Accept: application/json
      body: 
        name: "{{ item.name }}"
        online: "true"
        storage:
          blobStoreName: default
          strictContentTypeValidation: "true"
          writePolicy: allow_once
        cleanup:
          policyNames:
          - string
        component:
          proprietaryComponents: "true"
        maven:
          versionPolicy: MIXED
          layoutPolicy: STRICT
          contentDisposition: ATTACHMENT
      force_basic_auth: "yes"
      status_code: 201
      body_format: json
    with_items: "{{ mavenrepos }}"
    ignore_errors: "yes"
    